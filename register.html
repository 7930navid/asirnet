<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=0.7">
<title>Register</title>

<style>
:root{
    --green:#1f8f3a;
    --light:#eafff0;
}

*{
    box-sizing:border-box;
    font-family: Arial, sans-serif;
}

body{
    margin:0;
    background:#f6fff9;
}

/* HEADER */
header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:15px 20px;
    border-bottom:3px solid var(--green);
    background:white;
}

header h2{
    color:var(--green);
}

/* CONTAINER */
.container{
    max-width:550px;
    margin:40px auto;
    background:white;
    padding:30px;
    border-radius:25px;
    box-shadow:0 10px 30px rgba(0,0,0,.08);
    text-align:center;
}

/* INPUTS */
input, textarea{
    width:100%;
    padding:15px;
    margin-top:15px;
    border-radius:18px;
    border:2px solid var(--green);
    font-size:16px;
    background:var(--light);
    outline:none;
}

input:focus, textarea:focus{
    border-color:#0c5;
}

textarea{
    height:110px;
    resize:none;
}

/* AVATAR */
.avatar-box{
    display:flex;
    align-items:center;
    margin-top:15px;
    border:2px solid var(--green);
    border-radius:18px;
    background:var(--light);
    cursor:pointer;
    position: relative;
}

.avatar-text{
    flex:1;
    padding:15px;
    font-size:20px;
}

.avatar-btn{
    padding:15px 18px;
    font-size:20px;
    background:none;
    border-left:2px solid var(--green);
}

/* BUTTON */
button{
    margin-top:25px;
    padding:15px;
    width:100%;
    font-size:18px;
    border-radius:20px;
    border:none;
    cursor:pointer;
}

#submit{
    background:var(--green);
    color:white;
}

#submit:hover{
    background:#15752d;
}

/* AVATAR MODAL */
#avatarModal{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.55);
}

#avatarModal .box{
    background:white;
    width:90%;
    max-width:600px;
    margin:50px auto;
    padding:25px;
    border-radius:25px;
    text-align:center;
}

.avatar-list button{
    width:60px;
    height:60px;
    font-size:26px;
    margin:6px;
    border:none;
    border-radius:15px;
    background:#e6f6ea;
}

.close{
    float:right;
    font-size:28px;
    background:none;
    color: red;
}
</style>
</head>

<body>

<header>
    <img src="https://i.ibb.co/wNpFN8qH/IMG-20251103-150220.jpg" width="130">
</header>

<div class="container">

    <input id="username" placeholder="Full Name">
    <input id="useremail" type="email" placeholder="Email Address">
    <input id="password" type="password" placeholder="Password">

    <textarea id="bio" placeholder="Your goal / focus"></textarea>

    <div class="avatar-box" onclick="openAvatar()">
        <div id="avatarText" class="avatar-text">Choose an Avatar</div>
        <div class="avatar-btn">â–¼</div>
    </div>
 
<p style="font-size: 20px; color: red;" id="alert"></p>

    <button id="submit" onclick="register()">Create Account</button>
</div>

<!-- AVATAR MODAL -->
<div id="avatarModal">
    <div class="box" style="position:relative">
        <button class="close" onclick="closeAvatar()">Ã—</button>
        <h3>Select Avatar</h3>

        <div class="avatar-list" style="position:relative">
<button onclick="setAvatar('ğŸ˜€')">ğŸ˜€</button>
<button onclick="setAvatar('ğŸ˜ƒ')">ğŸ˜ƒ</button>
<button onclick="setAvatar('ğŸ˜„')">ğŸ˜„</button>
<button onclick="setAvatar('ğŸ˜')">ğŸ˜</button>
<button onclick="setAvatar('ğŸ˜†')">ğŸ˜†</button>
<button onclick="setAvatar('ğŸ˜…')">ğŸ˜…</button>
<button onclick="setAvatar('ğŸ˜‚')">ğŸ˜‚</button>
<button onclick="setAvatar('ğŸ¤£')">ğŸ¤£</button>
<button onclick="setAvatar('ğŸ˜Š')">ğŸ˜Š</button>
<button onclick="setAvatar('ğŸ˜‡')">ğŸ˜‡</button>

<button onclick="setAvatar('ğŸ™‚')">ğŸ™‚</button>
<button onclick="setAvatar('ğŸ˜‰')">ğŸ˜‰</button>
<button onclick="setAvatar('ğŸ˜Œ')">ğŸ˜Œ</button>
<button onclick="setAvatar('ğŸ˜')">ğŸ˜</button>
<button onclick="setAvatar('ğŸ¥°')">ğŸ¥°</button>
<button onclick="setAvatar('ğŸ˜˜')">ğŸ˜˜</button>
<button onclick="setAvatar('ğŸ˜')">ğŸ˜</button>
<button onclick="setAvatar('ğŸ¤“')">ğŸ¤“</button>
<button onclick="setAvatar('ğŸ§')">ğŸ§</button>
<button onclick="setAvatar('ğŸ¤©')">ğŸ¤©</button>

<button onclick="setAvatar('ğŸ¥³')">ğŸ¥³</button>
<button onclick="setAvatar('ğŸ˜œ')">ğŸ˜œ</button>
<button onclick="setAvatar('ğŸ¤ª')">ğŸ¤ª</button>
<button onclick="setAvatar('ğŸ˜')">ğŸ˜</button>
<button onclick="setAvatar('ğŸ¤”')">ğŸ¤”</button>
<button onclick="setAvatar('ğŸ˜´')">ğŸ˜´</button>
<button onclick="setAvatar('ğŸ˜')">ğŸ˜</button>
<button onclick="setAvatar('ğŸ˜¶')">ğŸ˜¶</button>
<button onclick="setAvatar('ğŸ™„')">ğŸ™„</button>
<button onclick="setAvatar('ğŸ˜')">ğŸ˜</button>

<button onclick="setAvatar('ğŸ¦¸')">ğŸ¦¸</button>
<button onclick="setAvatar('ğŸ¦¹')">ğŸ¦¹</button>
<button onclick="setAvatar('ğŸ§™')">ğŸ§™</button>
<button onclick="setAvatar('ğŸ§‘â€ğŸ“')">ğŸ§‘â€ğŸ“</button>
<button onclick="setAvatar('ğŸ‘¨â€ğŸ’»')">ğŸ‘¨â€ğŸ’»</button>
<button onclick="setAvatar('ğŸ‘©â€ğŸ’»')">ğŸ‘©â€ğŸ’»</button>
<button onclick="setAvatar('ğŸ§ ')">ğŸ§ </button>
<button onclick="setAvatar('ğŸ“')">ğŸ“</button>
<button onclick="setAvatar('ğŸ¯')">ğŸ¯</button>
<button onclick="setAvatar('ğŸš€')">ğŸš€</button>
        </div>
    </div>
</div>

<script>
const alertBox = document.getElementById('alert');
const avatarModal = document.getElementById("avatarModal");
const avatarText = document.getElementById("avatarText");

function openAvatar(){
    avatarModal.style.display="block";
}
function closeAvatar(){
    avatarModal.style.display="none";
}
function setAvatar(a){
    avatarText.innerText = a;
    closeAvatar();
}

avatarModal.addEventListener("click", e=>{
    if(e.target === avatarModal) closeAvatar();
});

async function register(){
    alertBox.innerHTML = "";

    const username = document.getElementById("username").value.trim();
    const email = document.getElementById("useremail").value.trim();
    const password = document.getElementById("password").value.trim();
    const bio = document.getElementById("bio").value.trim();
    const avatar = avatarText.innerText;

    if(!username || !email || !password || !bio || avatar==="Choose an Avatar"){
        alertBox.innerHTML = "âš  Please fill all fields";
        return;
    }

    if(password.length < 6){
        alertBox.innerHTML = "âš  Password must be at least 6 characters";
        return;
    }

    try{
        const res = await fetch("https://users-server-xyvg.onrender.com/signup",{
            method:"POST",
            headers:{ "Content-Type":"application/json" },
            body:JSON.stringify({ username, email, password, bio, avatar })
        });

        const data = await res.json();

        if(res.ok){

            /* âœ… SAVE ALL DATA LOCALLY */
            const userData = {
                username: username,
                email: email,
                avatar: avatar,
                bio: bio,
                password: password
                 };

            localStorage.setItem("user", JSON.stringify(userData));

            /* âœ… REDIRECT */
            location.href = "asirnet.html";

        }else{
            alertBox.innerHTML = data.message;
        }
    }catch{
        alertBox.innerHTML = "âŒ Server error. Try again.";
    }
}
</script>

</body>
</html>